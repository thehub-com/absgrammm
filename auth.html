<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ABSgram — Вход</title>

  <link rel="stylesheet" href="CSS/style.css">

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<div class="auth-page">
  <div class="auth-card">
    <h1>ABSgram</h1>
    <p class="subtitle">Secure messenger</p>

    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Пароль">

    <button class="btn-primary" onclick="login()">Войти</button>

    <div class="divider">или</div>

    <button class="btn-google" onclick="loginGoogle()">
      <span>G</span> Войти через Google
    </button>

    <p class="policy">
      Продолжая, вы соглашаетесь с правилами
    </p>
  </div>
</div>

<script>
  const supabase = window.supabase.createClient(
    "https://zdmtwnvaksdbvutrpcnr.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpkbXR3bnZha3NkYnZ1dHJwY25yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1Mjg4NjcsImV4cCI6MjA4MzEwNDg2N30.QztruYbzPeF8CrZmT_FhMw6VHc1-289qqJ8Qs4Z7nVc"
  );

  async function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    const { error } = await supabase.auth.signInWithPassword({
      email,
      password
    });

    if (error) {
      alert(error.message);
    } else {
      window.location.href = "messenger.html";
    }
  }

  async function loginGoogle() {
    await supabase.auth.signInWithOAuth({
      provider: "google",
      options: {
        redirectTo: window.location.origin + "/messenger.html"
      }
    });
  }
</script>

</body>
</html>
